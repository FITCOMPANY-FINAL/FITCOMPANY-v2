import{a as s}from"./chunk-Y5NMKK7J.js";import{M as n,R as a,Yb as i}from"./chunk-4VXNIXON.js";var l=class o{http=a(i);TOKEN_KEY="fit_token";login(e){return this.http.post(`${s.apiBaseUrl}/login`,e)}saveToken(e){localStorage.setItem(this.TOKEN_KEY,e)}getToken(){return localStorage.getItem(this.TOKEN_KEY)}clearSession(){localStorage.removeItem(this.TOKEN_KEY)}isAuthenticated(){let e=this.getToken();if(!e)return!1;let t=this.decodePayload(e);if(!t?.exp)return!0;let r=Math.floor(Date.now()/1e3);return t.exp>r}getUserFromToken(){let e=this.getToken();return e?this.decodePayload(e):null}getFormulariosFromToken(){return this.getUserFromToken()?.formularios??[]}decodePayload(e){try{let[,t]=e.split("."),r=atob(t.replace(/-/g,"+").replace(/_/g,"/"));return JSON.parse(decodeURIComponent(escape(r)))}catch{return null}}static \u0275fac=function(t){return new(t||o)};static \u0275prov=n({token:o,factory:o.\u0275fac,providedIn:"root"})};export{l as a};
